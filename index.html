<!doctype html>
<html>
    <head>
        <meta charset="utf-8">
        <meta name="keywords" content="">
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover">
        <link rel="shortcut icon" type="image/png" href="favicon.png">
        <link rel="stylesheet" type="text/css" href="/css/bootstrap.min.css">
        <link rel="stylesheet" type="text/css" href="/style.css">
        <link rel="stylesheet" type="text/css" href="/css/animate.min.css">
        <link rel="stylesheet" type="text/css" href="/css/font-awesome.min.css">
        <title>ImageTextReader</title>
    <!-- Analytics -->
    <!-- Analytics END -->
    </head>
    <body>
    <!-- Main container -->
    <div class="page-container">
        <!-- bloc-0 -->
        <div class="bloc bg-tile-d-bg bg-repeat none b-divider l-bloc" id="bloc-0">
            <div class="container bloc-lg">
                <div class="row">
                    <div class="col-sm-6 col">
                        <img id="text-image" src="img/lazyload-ph.png" data-src="img/placeholder-image.png" class="img-fluid mx-auto d-block lazyload" alt="placeholder image" />
                        <div class="divider-h">
                            <span class="divider"></span>
                        </div>
                        <input id="file-input" type="file" name="name" style="display: none;" />
                        <div id="load-image" class="btn btn-lg btn-block btn-gainsboro animated pulse-hvr">Загрузить изображение
                            <br>
                        </div>
                        </div>
                        <div class="col-sm-5 col">
                            <form id="form_23851" data-form-type="blocs-form" novalidate>
                                <div class="form-group">
                                    <label class="d-block">Результат</label>
                                    <textarea readonly class="form-control" style="height: 400px" rows="4" cols="50" id="textarea_1301"></textarea>
                                    <div class="form-group">
                                        <label>Время
                                            <br>
                                            </label>
                                            <input readonly class="form-control" id="input_759" />
                                            <div class="divider-h">
                                                <span class="divider"></span>
                                            </div>
                                        </div>
                                            <div id="recognize-button" class="btn btn-block btn-xl animated pulse-hvr btn-columbia-blue" data-placement="left" data-toggle="tooltip" title="Тык здесь и будет чудо!">
                                                <span class="fa fa-star icon-spacer"></span>Распознать
                                                <br>
                                            </div>
                                            <div id="reset-button" class="btn btn-block animated pulse-hvr btn-gainsboro" data-placement="bottom" data-toggle="tooltip" title="Сброс данных для распознавания">Сбросить</div>
                                        </div>
                                    </form>
                                </div>
                            </div>
                        </div>
                    </div>
                    <!-- bloc-0 END -->
                    <!-- ScrollToTop Button -->
                    <a class="bloc-button btn btn-d scrollToTop" onclick="scrollToTarget('1',this)">
                        <span class="fa fa-chevron-up"></span>
                    </a>
                    <!-- ScrollToTop Button END-->
                    <!-- bloc-2 -->
                    <div class="bloc bgc-black d-bloc" id="bloc-2">
                        <div class="container bloc-lg">
                            <div class="row">
                                <div class="col-md-3 col-sm-6">
                                    <h4 class="mg-md text-sm-left text-center tc-white h4-style">ImageTextReader 2019 All rights reserved</h4>
                                </div>
                            </div>
                        </div>
                    </div>
                    <!-- bloc-2 END -->
                </div>
                <!-- Main container END -->
                <script src="./js/jquery-3.3.1.min.js?8187"></script>
                <script src="./js/bootstrap.bundle.min.js?8885"></script>
                <script src="./js/blocs.min.js?1940"></script>
                <script src="./js/jqBootstrapValidation.js"></script>
                <script src="./js/formHandler.js?2785"></script>
                <script src="./js/jquery.touchSwipe.min.js" defer></script>
                <script src="./js/lazysizes.min.js" defer></script>
                <!-- Additional JS END -->
                <!-- Preloader -->
                <div id="page-loading-blocs-notifaction" class="page-preloader"></div>
                <!-- Preloader END -->
                <!-- JS Logic-->
                <script> 
                    $("#load-image").on("click", function() {
                        $("#file-input").trigger("click");
                    });
                    $("#file-input").on("change", function(){
                        $("#text-image").attr("src", this.files[0].name);
                    });
                    $("#reset-button").on("click", function(){
                        $("#text-image").attr("src", "img/placeholder-image.png");
                        $("#file-input").val("");
                        document.getElementById("textarea_1301").value = "";
                        document.getElementById("input_759").value = "";
                    });
                    $("#recognize-button").on("click",function () {
                        var image = $("#text-image").attr("src");
                        if (image === '' || image === 'img/placeholder-image.png') {
                            alert('Вы не выбрали изображение')
                        } else {
                            $.ajax({
                                type: "POST",
                                url: '/recognize',
                                contentType: 'application/json',
                                async: true,
                                data: JSON.stringify({"image_path": image}),
                                success: function (data) {
                                    document.getElementById("textarea_1301").value = data["text"];
                                    document.getElementById("input_759").value = data["time"];
                                }
                            });
                        }
                    });
                </script>
                <!-- JS Logic -->
            </body>
        </html>